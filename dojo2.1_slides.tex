\documentclass{beamer}
\usepackage{hyperref}
\definecolor{links}{HTML}{2A1B81}
\hypersetup{colorlinks,linkcolor=,urlcolor=links}

\usepackage{verbatim}

\title{Haskell Dojo 2}
\subtitle{Taking it to practice}
\date{\today}
\author{Janne Haskell}

\begin{document}

\frame{\titlepage}

%-----------------------------------------------------------------
\begin{frame}[fragile]

\frametitle{Haskell Dojo 2}

We will incrementally work on an example project that demonstrates:

\begin{itemize}
  \item Basic project setup and compilation
  \item Parsing JSON
  \item I/O (working in the IO monad, networking)
  \item Monad basics
  \item Handling state in a pure language (game state, state monad)
\end{itemize}

\end{frame}
%-----------------------------------------------------------------

\begin{frame}[fragile]
\frametitle{Resources}

Links:

\begin{itemize}
  \item \href{https://github.com/nurpax/haskell-dojo/wiki/Haskell-Dojo-\%232}{Dojo wiki}
  \item \href{http://www.haskell.org/haskellwiki/How_to_write_a_Haskell_program}{Excellent starter guide}
\end{itemize}

\end{frame}

%-----------------------------------------------------------------
\begin{frame}[fragile]

\frametitle{Today}

Today we will practice:

\begin{itemize}
  \item How to setup and build a Haskell project
  \item How to parse JSON
\end{itemize}

\end{frame}
%-----------------------------------------------------------------


%-----------------------------------------------------------------
\begin{frame}[fragile]

\frametitle{Project setup}

Haskell projects are built using {\em cabal}

\begin{itemize}
  \item Think ``make'' for Haskell
  \item Your project details are declared with a {\em .cabal} file.
\end{itemize}

A {\em .cabal} file contains:
\begin{itemize}
  \item What source files make up your project
  \item What libraries are you linking against
  \item ..plus other stuff which you can mostly just copy\&paste over
\end{itemize}

% TODO move to a later slide?
\medskip
See the Haskell wiki on \href{http://www.haskell.org/haskellwiki/How_to_write_a_Haskell_program}{How
  to write a Haskell program} for a more comprehensive guide.

\end{frame}
%-----------------------------------------------------------------


%-----------------------------------------------------------------
\begin{frame}[fragile]
\frametitle{Interactive - let's try it}

Let's create an executable project with source code under \verb|src/|
\medskip

Run the below and respond to the interactive prompts:

\begin{verbatim}
mkdir test-project  # do not use underscore here!
cd test-project
mkdir src
cabal init -m
\end{verbatim}

Create a source file \verb|src/Main.hs| with contents:

\begin{verbatim}
main :: IO ()
main = putStrLn "Hello world from Haskell"
\end{verbatim}

\end{frame}
%-----------------------------------------------------------------

%-----------------------------------------------------------------
\begin{frame}[fragile]
\frametitle{Interactive - let's try it}
Let cabal know which module contains your \verb+main+ by editing the .cabal file:

\begin{verbatim}
$ diff -u test-project.cabal.orig test-project.cabal
--- test-project.cabal.orig     Tue Oct 30 20:36:16 2012
+++ test-project.cabal  Tue Oct 30 20:35:38 2012
@@ -9,4 +9,5 @@

 executable test-project
   build-depends:       base ==4.5.*
+  main-is:             Main.hs
   hs-source-dirs:      src
\end{verbatim}

\end{frame}

%-----------------------------------------------------------------
\begin{frame}[fragile]
\frametitle{Interactive - let's try it}

Your example project is now ready to be built:

\begin{verbatim}
cabal configure
cabal build
\end{verbatim}

To run it:
\begin{verbatim}
$ ./dist/build/test-project/test-project
Hello world from Haskell
\end{verbatim}

\end{frame}

\end{document}
